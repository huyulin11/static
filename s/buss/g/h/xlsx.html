<link type="text/css" rel="stylesheet" href="/s/c/all.css" />

<div class="col-md-12">
    <div>
        <input type="file" id="excel-file" />
        <input type="button" value="普通按钮" />
    </div>
</div>
<script src="/s/j/jquery-1.12.2.min.js"></script>
<script src="/s/j/xlsx/xlsx.core.min.js"></script>
<script type="module">
    import "/s/buss/g/j/g.p.js";
    function readWorkbookFromLocalFile(file, callback) {
        var reader = new FileReader();
        reader.onload = function (e) {
            var data = e.target.result;
            var workbook = XLSX.read(data, { type: 'binary' });
            if (callback) callback(workbook);
        };
        reader.readAsBinaryString(file);
    }

    function submit(e) {
        var files = e.target.files;
        for (let file of files) {
            readWorkbookFromLocalFile(file, function (workbook) {
                var fromTo = '', persons = [];
                for (var sheet in workbook.Sheets) {
                    if (workbook.Sheets.hasOwnProperty(sheet)) {
                        fromTo = workbook.Sheets[sheet]['!ref'];
                        console.log(fromTo);
                        persons = persons.concat(XLSX.utils.sheet_to_json(workbook.Sheets[sheet]));
                    }
                }
                console.log(persons);
            });
        }
    };

    $('#excel-file').on("change", submit);
</script>